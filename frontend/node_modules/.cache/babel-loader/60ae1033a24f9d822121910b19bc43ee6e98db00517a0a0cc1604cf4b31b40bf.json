{"ast":null,"code":"import React,{useState}from'react';import{useAuth}from'../contexts/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DataCleanup=_ref=>{let{isOpen,onClose}=_ref;const{user}=useAuth();const[loading,setLoading]=useState(false);const[message,setMessage]=useState('');const cleanupData=()=>{setLoading(true);setMessage('');try{// Get all keys from localStorage\nconst allKeys=Object.keys(localStorage);let deletedCount=0;let preservedCount=0;allKeys.forEach(key=>{// Preserve data for currently signed-in user\nif(user&&(key===\"academic_\".concat(user.id)||key===\"predictions_\".concat(user.id)||key==='user'// Preserve current user session\n)){preservedCount++;}else{// Delete all other data\nlocalStorage.removeItem(key);deletedCount++;}});setMessage(\"\\u2705 Cleanup completed! Deleted \".concat(deletedCount,\" items, preserved \").concat(preservedCount,\" items for current user.\"));// Refresh the page after 2 seconds to show effects\nsetTimeout(()=>{window.location.reload();},2000);}catch(error){setMessage('‚ùå Error during cleanup: '+error.message);}finally{setLoading(false);}};const getDataSummary=()=>{const allKeys=Object.keys(localStorage);const userDataKeys=allKeys.filter(key=>key.startsWith('academic_')||key.startsWith('predictions_')||key==='user');return{total:allKeys.length,userData:userDataKeys.length,other:allKeys.length-userDataKeys.length};};if(!isOpen)return null;const dataSummary=getDataSummary();return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-lg shadow-lg w-full max-w-md\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-6\",children:\"\\uD83D\\uDDD1\\uFE0F Data Cleanup\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 p-4 bg-gray-50 rounded\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold mb-2\",children:\"Current Storage Status:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1 text-sm\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Total items: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",children:dataSummary.total})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"User data items: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-blue-600\",children:dataSummary.userData})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Other items: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-orange-600\",children:dataSummary.other})]})]})]}),user&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 p-4 bg-green-50 rounded\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold mb-2\",children:\"Will Preserve:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1 text-sm\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u2705 Current user session\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u2705 Academic data for \",user.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u2705 Predictions for \",user.name]})]})]}),!user&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 p-4 bg-yellow-50 rounded\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold mb-2 text-yellow-800\",children:\"\\u26A0\\uFE0F Warning:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-yellow-700\",children:\"No user is currently signed in. All data will be deleted including user sessions.\"})]}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 rounded text-sm \".concat(message.includes('‚úÖ')?'bg-green-100 text-green-800':'bg-red-100 text-red-800'),children:message}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:cleanupData,disabled:loading,className:\"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 disabled:opacity-50\",children:loading?'Cleaning...':'Delete All Data Except Signed-in User'}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400\",children:\"Cancel\"})]})]})});};export default DataCleanup;","map":{"version":3,"names":["React","useState","useAuth","jsx","_jsx","jsxs","_jsxs","DataCleanup","_ref","isOpen","onClose","user","loading","setLoading","message","setMessage","cleanupData","allKeys","Object","keys","localStorage","deletedCount","preservedCount","forEach","key","concat","id","removeItem","setTimeout","window","location","reload","error","getDataSummary","userDataKeys","filter","startsWith","total","length","userData","other","dataSummary","className","children","name","includes","onClick","disabled"],"sources":["C:/Student Detection System/frontend/src/components/DataCleanup.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\n\r\nconst DataCleanup = ({ isOpen, onClose }) => {\r\n  const { user } = useAuth();\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState('');\r\n\r\n  const cleanupData = () => {\r\n    setLoading(true);\r\n    setMessage('');\r\n\r\n    try {\r\n      // Get all keys from localStorage\r\n      const allKeys = Object.keys(localStorage);\r\n      let deletedCount = 0;\r\n      let preservedCount = 0;\r\n\r\n      allKeys.forEach(key => {\r\n        // Preserve data for currently signed-in user\r\n        if (user && (\r\n          key === `academic_${user.id}` || \r\n          key === `predictions_${user.id}` ||\r\n          key === 'user' // Preserve current user session\r\n        )) {\r\n          preservedCount++;\r\n        } else {\r\n          // Delete all other data\r\n          localStorage.removeItem(key);\r\n          deletedCount++;\r\n        }\r\n      });\r\n\r\n      setMessage(`‚úÖ Cleanup completed! Deleted ${deletedCount} items, preserved ${preservedCount} items for current user.`);\r\n      \r\n      // Refresh the page after 2 seconds to show effects\r\n      setTimeout(() => {\r\n        window.location.reload();\r\n      }, 2000);\r\n      \r\n    } catch (error) {\r\n      setMessage('‚ùå Error during cleanup: ' + error.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getDataSummary = () => {\r\n    const allKeys = Object.keys(localStorage);\r\n    const userDataKeys = allKeys.filter(key => \r\n      key.startsWith('academic_') || \r\n      key.startsWith('predictions_') || \r\n      key === 'user'\r\n    );\r\n    \r\n    return {\r\n      total: allKeys.length,\r\n      userData: userDataKeys.length,\r\n      other: allKeys.length - userDataKeys.length\r\n    };\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const dataSummary = getDataSummary();\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white p-8 rounded-lg shadow-lg w-full max-w-md\">\r\n        <h2 className=\"text-2xl font-bold mb-6\">üóëÔ∏è Data Cleanup</h2>\r\n        \r\n        <div className=\"mb-6 p-4 bg-gray-50 rounded\">\r\n          <h3 className=\"font-semibold mb-2\">Current Storage Status:</h3>\r\n          <div className=\"space-y-1 text-sm\">\r\n            <p>Total items: <span className=\"font-bold\">{dataSummary.total}</span></p>\r\n            <p>User data items: <span className=\"font-bold text-blue-600\">{dataSummary.userData}</span></p>\r\n            <p>Other items: <span className=\"font-bold text-orange-600\">{dataSummary.other}</span></p>\r\n          </div>\r\n        </div>\r\n\r\n        {user && (\r\n          <div className=\"mb-6 p-4 bg-green-50 rounded\">\r\n            <h3 className=\"font-semibold mb-2\">Will Preserve:</h3>\r\n            <div className=\"space-y-1 text-sm\">\r\n              <p>‚úÖ Current user session</p>\r\n              <p>‚úÖ Academic data for {user.name}</p>\r\n              <p>‚úÖ Predictions for {user.name}</p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {!user && (\r\n          <div className=\"mb-6 p-4 bg-yellow-50 rounded\">\r\n            <h3 className=\"font-semibold mb-2 text-yellow-800\">‚ö†Ô∏è Warning:</h3>\r\n            <p className=\"text-sm text-yellow-700\">\r\n              No user is currently signed in. All data will be deleted including user sessions.\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {message && (\r\n          <div className={`mb-4 p-3 rounded text-sm ${message.includes('‚úÖ') ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>\r\n            {message}\r\n          </div>\r\n        )}\r\n        \r\n        <div className=\"flex justify-between\">\r\n          <button\r\n            onClick={cleanupData}\r\n            disabled={loading}\r\n            className=\"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 disabled:opacity-50\"\r\n          >\r\n            {loading ? 'Cleaning...' : 'Delete All Data Except Signed-in User'}\r\n          </button>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400\"\r\n          >\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DataCleanup;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}