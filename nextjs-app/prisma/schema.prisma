generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  email     String   @unique
  password  String
  role      String   @default("student") // "student" or "admin"
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  student   Student?
}

model Student {
  id                    String       @id @default(auto()) @map("_id") @db.ObjectId
  name                  String
  email                 String       @unique
  userId                String?      @unique @db.ObjectId
  user                  User?        @relation(fields: [userId], references: [id])
  enrollmentYear        Int
  major                 String
  attendancePercentage  Float
  internalMarks         Float
  assignmentScores      Float
  labPerformance        Float
  previousGpa           Float
  studyHours            Float
  socioAcademicFactors  String       // JSON string
  participationMetrics  Float
  createdAt             DateTime     @default(now())
  updatedAt             DateTime     @updatedAt
  predictions           Prediction[]
}

model Prediction {
  id                   String   @id @default(auto()) @map("_id") @db.ObjectId
  studentId            String   @db.ObjectId
  student              Student  @relation(fields: [studentId], references: [id])
  predictedPerformance String   // "High", "Medium", "Low"
  riskScore            Float
  recommendations      String   // JSON string
  featureImportance    String?  // JSON string (optional)
  createdAt            DateTime @default(now())
}
